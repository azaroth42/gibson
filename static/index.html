<!DOCTYPE html>
<html>

<head>
    <title>Gibson Character Dashboard</title>
    <style>
        body {
            font-family: monospace;
            background: #111;
            color: #eee;
            padding: 20px;
        }

        a {
            color: #00f3ff;
            text-decoration: none;
            font-size: 1.2em;
        }

        ul {
            list-style: none;
            padding: 0;
        }

        li {
            margin-bottom: 10px;
            border-bottom: 1px solid #333;
            padding-bottom: 5px;
        }

        .delete-btn {
            color: #ff0055;
            margin-left: 10px;
            cursor: pointer;
            font-weight: bold;
        }

        .delete-btn:hover {
            text-decoration: underline;
        }

        input,
        select {
            background: #222;
            border: 1px solid #444;
            color: white;
            padding: 5px;
        }

        button {
            background: #00f3ff;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
            font-family: monospace;
        }
    </style>
</head>

<body>
    <h1>All Characters</h1>
    <ul id="char-list"></ul>

    <h3>Create New Character</h3>
    <input type="text" id="new-name" placeholder="Name">
    <select id="new-playbook">
        <option value="" disabled selected>Select Playbook</option>
        <option value="Courier">Courier</option>
        <option value="Driver">Driver</option>
        <option value="Face">Face</option>
        <option value="Infiltrator">Infiltrator</option>
        <option value="Investigator">Investigator</option>
        <option value="Juicer">Juicer</option>
        <option value="Killer">Killer</option>
        <option value="Netrunner">Netrunner</option>
        <option value="Razor">Razor</option>
        <option value="Streamer">Streamer</option>
        <option value="Tech">Tech</option>
    </select>
    <button onclick="createChar()">Create</button>

    <script>
        async function loadChars() {
            const res = await fetch('/characters');
            const chars = await res.json();
            const list = document.getElementById('char-list');
            list.innerHTML = '';
            chars.forEach(char => {
                const li = document.createElement('li');
                li.innerHTML = `<a href="/static/sheet.html?id=${char.id}">${char.name} (${char.playbook})</a> 
                                <span class="delete-btn" onclick="deleteChar(${char.id})">DELETE</span>`;
                list.appendChild(li);
            });
        }

        async function createChar() {
            const name = document.getElementById('new-name').value;
            const playbook = document.getElementById('new-playbook').value;
            if (!name || !playbook) return;
            await fetch('/characters', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ name, playbook })
            });
            document.getElementById('new-name').value = '';
            document.getElementById('new-playbook').value = '';
            loadChars();
        }

        async function deleteChar(id) {
            if (!confirm("Are you sure you want to delete this character?")) return;
            await fetch(`/characters/${id}`, { method: 'DELETE' });
            loadChars();
        }

        loadChars();
    </script>
</body>

</html>